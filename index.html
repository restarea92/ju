<style>

#visual-section {
    .content-wrapper-wide {
        width: 100lvw;
        position: relative;
    }
    .content {
        margin:0 auto;
        display:grid;
        grid-template-columns:repeat(12, 1fr);
        max-width: var(--small-content-width);
        max-height: 100%;
        .content-text {
            z-index: 2;
            user-select: none;
            grid-column: 1 / 9;
            grid-row: 6 / auto;
		    will-change: transform;
            transform: translateZ(0);
            p {
                word-break: keep-all;
                color:#b6b6b9;
                text-shadow: 
                    0 0 21px rgba(0, 0, 0, 1), 
                    0 0 34px rgba(0, 0, 0, 1), 
                    0 0 55px rgba(0, 0, 0, 1),
            }
            strong {
                color: white;
                font-weight: 700;
            }
        }
        .content-image { 
            overflow: visible;
            visibility: visible;
            content-visibility: visible;
            z-index: 1;
            padding: 1px;
		    will-change: transform;
            transform: translateZ(0);
            user-select: none;
            grid-column: 5 / 13;
            grid-row: 4 / 12;
            img {
                overflow: visible;
                visibility: visible;
                content-visibility: visible;
                will-change: transform;
                transform: translateZ(0);
                object-fit:contain;
                object-position: right;
                width: 100%;
                height: 100%;
            }
        }
        .content-title {
            z-index: 3;
		    will-change: transform;
            transform: translateZ(0);
            grid-column: 1 / 13;
            grid-row: 1 / 4;
            user-select: none;
                h2 {
                    text-align: left;
                    color:white;
                    font-size: var(--h2-font-size);
                    padding-bottom: calc(var(--h2-font-size) / 2);
                }
        }
    }
    .content.second {
        .content-title {
		  
        }
        .content-text {
		  
            grid-column: 6 / 13;
            grid-row: 5 / auto;
        }        
        .content-image {
            grid-column: 1 / 9;
            grid-row: 2 / 10;
        }        
    }
}
#horizontal-wrapper {
    overflow: hidden;
    position: relative;
}

.horizontal-content {
    display: flex;
    flex-direction: row;
    width: max-content;
    height: 100lvh;
}

</style>
<div class="scroll-marker top">VIEWPORT TOP</div>
<div class="scroll-marker center">VIEWPORT CENTER</div>
<div class="scroll-marker bottom">VIEWPORT BOTTOM</div>
<div id="state-el"></div>
<div class="visual-section sticky-wrapper" id="visual-section">
    <div class="sticky-element">
        <div 
            class="sticky-element-background"
        >
        <video id="landscapeVideo" autoplay muted playsinline loop style="width:100%; height:100%; display:none; object-fit: cover; filter:brightness(0.75)">
            <source src="https://restarea92.github.io/ju/vttsp.mp4" type="video/mp4" />
        </video>

        <video id="portraitVideo" autoplay muted playsinline loop style="width:100%; height:100%; display:none; object-fit: cover; filter:brightness(0.75)">
            <source src="https://restarea92.github.io/ju/vttsm.mp4" type="video/mp4" />
        </video>
        </div>
        <div class="content-wrapper sticky-element-content">
		  <div class="content" style="min-height:calc(100lvh - var(--default-margin) * 2); display:flex;">
                <div class="title" style="">
                <h2>
                    JU가 제시하는 보컬 교육의 미래.
                </h2>
            </div>
		  </div>
        </div>
    </div>
    <div id="scroll-trigger" style="position:relative; min-height: 100lvh; background: transparent; user-select: none; z-index: -1;">
	Trigger
    </div>
    
<style>
#multi-scroll {
}
.multi-scroll-item {
    width: 100lvw;
    min-width: 100lvw;
    height: 100lvh;
    display: flex;
    align-items: center;
    justify-content: center;
}
  
.horizontal-spacer {
    height: 300lvh;
}
.horizontal-container {
    position: sticky;
    top:0;
    display: flex;
    flex-wrap:nowrap;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', () => {
    function isLandscape() {
        return window.innerWidth > window.innerHeight;
    }

    function updateVideo() {
        const landscapeVideo = document.getElementById('landscapeVideo');
        const portraitVideo = document.getElementById('portraitVideo');

        if (isLandscape()) {
        landscapeVideo.style.display = 'block';
        portraitVideo.style.display = 'none';
        landscapeVideo.play();
        portraitVideo.pause();
        } else {
        landscapeVideo.style.display = 'none';
        portraitVideo.style.display = 'block';
        portraitVideo.play();
        landscapeVideo.pause();
        }
    }

    updateVideo();

    window.addEventListener('resize', updateVideo);
    window.addEventListener('orientationchange', updateVideo);
});
</script>
    <style>
        .scroll-marker, #state-el {
            font-size: 0.75rem;
            font-weight: 900;
            width: fit-content;
            min-width: 200px;
            height: fit-content;
            border: 1px solid red;
            position: fixed;
            right: 0;
            color: white;
            z-index: 9999;
            background: navy;
            text-align: left;
        }
        #state-el {
            top:0;
            left:0;
            right: unset;
        }
        .scroll-marker.top {
            top:0;
        }
        .scroll-marker.center {
            top:50%;
            transform: translateY(-50%);
        }
        .scroll-marker.bottom {
            bottom:0;
        }
        .horizontal-spacer {
            position: relative;
            

            .scroll-marker {
                text-align: right;
                position: absolute;
                margin-right: 200px;
            }


        }


    </style>
    <div id="multi-scroll">
        <div class="horizontal-spacer">
            <div class="scroll-marker top">TOP</div>
            <div class="scroll-marker center">CENTER</div>
            <div class="scroll-marker bottom">BOTTOM</div>
            <div class="horizontal-container" style="background: radial-gradient(circle,rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.3) 100%); backdrop-filter: blur(16px);">
                <section id="multi-scroll-item1" class="multi-scroll-item">

                    <div class="content">
                        <div class="content-title">
                            <h2>
                                첫 단추부터 제대로.
                            </h2>
                        </div>
                        <div class="content-text">
                            <p>
                                <strong>지피지기 백전불태.</strong> 맞춤형 솔루션으로 설계하는 체계적 커리큘럼. 아는 길로 나아가는 것보다 더 쉬운 것은 없죠. <br>
                                JU의 커리큘럼은 현재 나의 상태를 정확하게 아는 것, 그리고 앞으로 나아갈 길을 정하는 것으로부터 시작합니다.
                                다양한 발성적 문제들을 과학적 관점으로 분석하고 <strong>개개인에 맞춘 체계적 커리큘럼</strong>을 제시합니다. 
                            </p>
                        </div>
                        <div class="content-image">
                            <img src="https://restarea92.github.io/ju/image/ynin.jpg">
                        </div>
                    </div>
                </section>
                <section id="multi-scroll-item2" class="multi-scroll-item">
                    <div class="content second">
                        <div class="content-title">
                            <h2>
                                이렇게 쉽다니.
                            </h2>
                        </div>
                        <div class="content-text">
                        <p>
                            <strong>목표는 높게, 성장은 쉽게.</strong> 누구나 쉽게 이해할 수 있도록, 빠른 성장을 위해 설계된 JU만의 특별한 교육과정. 무엇이든 확실히 이해해야 비로소 내 것이 될 수 있죠.<br>
                            더 이상 어려운 이론들로 고민하지 마세요. 앞으로 일어날 놀라운 변화에만 집중하세요. 여러분들의 성장을 위한 고민은 이미 JU가 했으니까요.
                        </p>
                        </div>
                        <div class="content-image">
                            <img src="https://restarea92.github.io/ju/media/es.jpg">
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>

<script type="module">
    //import app from 'https://restarea92.github.io/ju/modules/horizontal-scroll.js';

    document.addEventListener('DOMContentLoaded', () => {
        //app.init();
    });


document.addEventListener('DOMContentLoaded', () => {

    const rectScrollTrigger = document.querySelector('#scroll-trigger');
    const stickyElement = document.querySelector('.sticky-element');
    const title = stickyElement.querySelector('.title');
    function minVwVh(value) {
        const vw = window.innerWidth * (value / 100);
        const vh = window.innerHeight * (value / 100);
        return Math.min(vw, vh);
    }


    const createTimeline = (options = {}) => {
        return gsap.timeline({
            scrollTrigger: {
                trigger: rectScrollTrigger, 
                start: "top bottom",
                end: "bottom bottom",
                scrub: 1,
                onUpdate: self => {
                    const progressPercent = (self.progress * 100).toFixed(0);
                },
                ...options,
            }
        });
    };
    

    const yOffset = minVwVh(10); 

    // 초기 위치 세팅
    if (title) gsap.set(title, { 
        y: yOffset * 3, 
        x: 0,
        opacity: 0,
        filter: 'blur(16px)'
    });
    createTimeline({
	    start:"top bottom",
		end:"top center"
	}).to(title, {
        y: 0,
        ease: "ease",
        opacity:1,
        filter: "blur(0px)",
        duration: 0.5
    }, 0);

    createTimeline({
        start: "bottom bottom",
        end: "bottom top",
    }).to(title, {
        y: yOffset * -3,
        ease: "ease",
        opacity:0,
        filter: "blur(16px)",
        duration: 0.5
    }, 0);

    gsap.to("body", {
        scrollBehavior: "smooth"
    });
});


</script>


<script type="module">
/**
 * Visual Scroll Animation Module
 * Handles scroll-triggered visual effects with GSAP and ScrollTrigger
 * @version 1.0.8
 */

import { initGSAP } from 'https://restarea92.github.io/ju/modules/gsapUtils.js';

const app = {

    // ========== Configuration ==========
    CONFIG: {
        VERSION: '1.0.8',
    },

    // ========== Initialization ==========
    /**
     * Initialize the application
     */
    init() {
        console.log(this.CONFIG.VERSION);
        if (!initGSAP()) return;
        this.initializeHorizontalScroll();
    },

    /**
     * Validate GSAP dependencies
     * @returns {boolean} Whether GSAP is properly loaded
     */
    // validateGSAP() {
    //     if (typeof gsap === 'undefined') {
    //         console.error('GSAP not loaded - include gsap.min.js');
    //         return false;
    //     }
    //     if (typeof ScrollTrigger === 'undefined') {
    //         console.error('ScrollTrigger not loaded or registered');
    //         return false;
    //     }
    //     return true;
    // },

    // ========== Horizontal Scroll ==========
    /**
     * Initialize horizontal scroll animations
     */
    initializeHorizontalScroll() {
        const horizontalSections = gsap.utils.toArray(".horizontal-spacer");
        
        horizontalSections.forEach((container) => {
            this.setupHorizontalContainer(container);
        });

        gsap.to("body", { scrollBehavior: "smooth" });
    },

    /**
     * Setup individual horizontal container
     * @param {Element} container - The horizontal container element
     */
    
    setupHorizontalContainer(container) {
        const sections = container.querySelectorAll(".multi-scroll-item");
        const elements = this.getHorizontalElements();
        const debugElements = this.getDebugElements();
        
        this.setInitialPositions(elements);
        this.createHorizontalTimelines(container, elements, debugElements);
        this.createMainHorizontalTimeline(container, sections, debugElements);
    },

    /**
     * Get horizontal scroll elements
     * @returns {Object} Object containing element references
     */
    getHorizontalElements() {
        const multiScrollItem1 = document.querySelector("#multi-scroll-item1");
        const multiScrollItem2 = document.querySelector("#multi-scroll-item2");

        return {
            text: multiScrollItem1?.querySelector('.content-text'),
            image: multiScrollItem1?.querySelector('.content-image'),
            title: multiScrollItem1?.querySelector('.content-title'),
            text2: multiScrollItem2?.querySelector('.content-text'),
            image2: multiScrollItem2?.querySelector('.content-image'),
            title2: multiScrollItem2?.querySelector('.content-title')
        };
    },

    /**
     * Get debug elements
     * @returns {Object} Object containing debug element references
     */
    getDebugElements() {
        return {
            progressEl: document.getElementById('progress-element'),
            progressEl2: document.getElementById('progress-element2'),
            stateEl: document.querySelector('#state-el')
        };
    },

    /**
     * Calculate viewport-based offsets
     * @returns {Object} Object containing calculated offsets
     */
    calculateOffsets() {
        const minVwVh = (value) => {
            const vw = window.innerWidth * (value / 100);
            const vh = window.innerHeight * (value / 100);
            return Math.min(vw, vh);
        };

        return {
            yOffset: minVwVh(10),
            xOffset: minVwVh(20)
        };
    },

    /**
     * Set initial positions for horizontal elements
     * @param {Object} elements - Element references
     */
    setInitialPositions(elements) {
        const { text, image, title, text2, image2, title2 } = elements;

        if (text)  gsap.set(text,  { xPercent: 0, yPercent: 75 });
        if (image) gsap.set(image, { xPercent: 0, yPercent: 100, filter: "blur(4px) brightness(0.25)"});
        if (title) gsap.set(title, { xPercent: 0, yPercent: 100 });

        if (text2)  gsap.set(text2,  { xPercent: 75, yPercent: 0, });
        if (image2) gsap.set(image2, { xPercent: 50, yPercent: 0, filter: "blur(4px) brightness(0.25)"});
        if (title2) gsap.set(title2, { xPercent: 25, yPercent: 0, });
    },

    /**
     * Create horizontal animation timelines
     * @param {Element} container - Container element
     * @param {Object} elements - Element references
     * @param {Object} debugElements - Debug element references
     */
    createHorizontalTimelines(container, elements, debugElements) {
        const { text, image, title, text2, image2, title2 } = elements;
        const { progressEl, progressEl2 } = debugElements;

        const timelineOptions = this.getTimelineOptions(progressEl, progressEl2);
        const createTimeline = this.timelineCreator(container);

        // First section animations
        this.createFirstSectionAnimations(createTimeline, timelineOptions, text, image, title);
        
        // Second section animations
        this.createSecondSectionAnimations(createTimeline, timelineOptions, text2, image2, title2);
    },

    /**
     * Get timeline options configuration
     * @param {Element} progressEl - First progress element
     * @param {Element} progressEl2 - Second progress element
     * @returns {Object} Timeline options
     */
    
    getTimelineOptions(progressEl, progressEl2) {
        return {
            firstIn: {
                start: "top center",
                end: "center 90%",
                onUpdate: self => {
                    const progressPercent = (self.progress * 100).toFixed(0);
                },
            },
            firstOut: {
                start: "center 90%",
                end: "center center",
            },
            secondIn: {
                start: "center center",
                end: "bottom 110%",
                onUpdate: self => {
                    const progressPercent = (self.progress * 100).toFixed(0);
                }
            },
            secondOut: {
                start: "bottom 90%",
                end: "bottom center",
            }
        };
    },


    /**
     * 주어진 컨테이너에 맞는 GSAP 타임라인 생성 함수를 반환.
     * 반환된 함수는 옵션 객체를 받아 ScrollTrigger 설정을 커스터마이징.
     * 
     * @param {Element} container - 타임라인의 ScrollTrigger가 작동할 대상 요소
     * @returns {Function} 타임라인 생성 함수 (options 객체를 받아서 gsap.timeline 생성)
     */
    timelineCreator(container) {
        return (options = {}) => {
            return gsap.timeline({
                scrollTrigger: {
                    trigger: container,
                    start: "top bottom",
                    end: "bottom 95%",
                    scrub: 1,
                    onUpdate: self => {
                        const progressPercent = (self.progress * 100).toFixed(0);
                    },
                    ...options,
                }
            });
        };
    },


    /**
     * Create first section animations
     * @param {Function} createTimeline - Timeline creation function
     * @param {Object} timelineOptions - Timeline options
     * @param {Element} text - Text element
     * @param {Element} image - Image element
     * @param {Element} title - Title element
     */
    createFirstSectionAnimations(createTimeline, timelineOptions, text, image, title) {

        const firstInTimeline =  createTimeline(timelineOptions.firstIn);
        firstInTimeline.to(text, {
            yPercent: 0,
            duration: 0.5
        }, 0);
        
        firstInTimeline.to(image, {
            yPercent: 0,
            duration: 1,
            filter: "blur(0px) brightness(0.5)",
        }, 0);
        
        firstInTimeline.to(title, {
            yPercent: 0,
            duration: 0.7
        }, 0);

        // First out animations
        const firstOutTimeline = createTimeline(timelineOptions.firstOut);
        firstOutTimeline.to(text, {
            xPercent: -25,
            duration: 1,
            filter: "blur(8px)",
            opacity: 1,
        }, 0.1);
        
        firstOutTimeline.to(image, {
            xPercent: -75,
            duration: 0.75
        }, 0.05);
        
        firstOutTimeline.to(title, {
            xPercent: -10,
            duration: 1,
            filter: "blur(8px)",
            opacity: 0.5,
        }, 0.15);
    },

    /**
     * Create second section animations
     * @param {Function} createTimeline - Timeline creation function
     * @param {Object} timelineOptions - Timeline options
     * @param {Element} text2 - Second text element
     * @param {Element} image2 - Second image element
     * @param {Element} title2 - Second title element
     */
    createSecondSectionAnimations(createTimeline, timelineOptions, text2, image2, title2) {

        const secondInTimeline =  createTimeline(timelineOptions.secondIn);
        secondInTimeline.to(text2, {
            xPercent: 0,
            duration: 0.5
        }, 0);
        
        secondInTimeline.to(image2, {
            xPercent: 0,
            duration: 1,
            filter: "blur(0px) brightness(0.5)",
        }, 0);
        
        secondInTimeline.to(title2, {
            xPercent: 0,
            duration: 0.7
        }, 0);

        // Second out animations
        const secondOutTimeline = createTimeline(timelineOptions.secondOut);
        
        secondOutTimeline.to(text2, {
            yPercent: -100,
            duration: 1,
            filter: "blur(8px)",
            opacity: 0.5,
        }, 0);
        
        secondOutTimeline.to(image2, {
            yPercent: -50,
            duration: 1
        }, 0.05); 
        
        secondOutTimeline.to(title2, {
            yPercent: -75,
            duration: 1,
            filter: "blur(8px)",
            opacity: 0.5,
        }, 0.1);
    },

    /**
     * Create main horizontal timeline
     * @param {Element} container - Container element
     * @param {NodeList} sections - Section elements
     * @param {Object} debugElements - Debug elements
     */
    createMainHorizontalTimeline(container, sections, debugElements) {
        const { stateEl, progressEl2 } = debugElements;

        const timeline = gsap.timeline({
            scrollTrigger: {
                trigger: container,
                pin: false,
                scrub: 1,
                start: "center bottom",
                end: "center top",
                onUpdate: self => {
                    if (stateEl) stateEl.textContent = 'For debug: SCROLLING';
                    const progressPercent = (self.progress * 100).toFixed(0);
                    if (progressEl2) progressEl2.textContent = 'For debug: ' + progressPercent + '%';
                },
                onLeave: self => {
                    if (stateEl) stateEl.textContent = 'For debug: END';
                },
                onLeaveBack: self => {
                    if (stateEl) stateEl.textContent = 'For debug: END (back)';
                }
            },
        });

        this.createSectionTimeline(timeline, sections);
    },

    /**
     * Create section timeline animations
     * @param {Object} timeline - GSAP timeline
     * @param {NodeList} sections - Section elements
     */
    createSectionTimeline(timeline, sections) {
        sections.forEach((section, index) => {
            if (index === 0) {
                timeline.to(sections, {
                    xPercent: 0,
                    duration: 1,
                });
            } else {
                timeline.to(sections, {
                    xPercent: -100 * index,
                    duration: 1,
                })
                .to(sections, {
                    xPercent: -100 * index,
                    duration: 1,
                });
            }
        });
    },

};
    document.addEventListener('DOMContentLoaded', () => {
        app.init();
    });

  </script>
